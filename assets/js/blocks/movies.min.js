!function(){function e(t,n,o){function r(s,l){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){return r(t[s][1][e]||e)},u,u.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}return e}()({1:[function(e,t,n){"use strict";var o=e("../components/PostSelector"),r=wp.blocks.registerBlockType,i=wp.editor.InspectorControls,s=wp.components,l=s.ServerSideRender,a=(s.TextControl,s.RangeControl),c=s.SelectControl,u=s.CheckboxControl;r("masvideos/movies",{title:"Movies Block",icon:"megaphone",category:"widgets",edit:function(e){var t=e.attributes,n=(e.className,e.setAttributes),r=t.limit,s=t.columns,p=t.orderby,f=t.order,d=t.ids,m=t.featured,h=t.top_rated;return[wp.element.createElement(i,null,wp.element.createElement(a,{label:"Limit",value:r,onChange:function(e){n({limit:e})},min:1,max:50}),wp.element.createElement(a,{label:"Columns",value:s,onChange:function(e){n({columns:e})},min:1,max:10}),wp.element.createElement(c,{label:"Orderby",value:p,options:[{label:"Title",value:"title"},{label:"Date",value:"date"},{label:"ID",value:"id"},{label:"Random",value:"rand"}],onChange:function(e){n({orderby:e})}}),wp.element.createElement(c,{label:"Order",value:f,options:[{label:"ASC",value:"ASC"},{label:"DESC",value:"DESC"}],onChange:function(e){n({order:e})}}),wp.element.createElement(o.PostSelector,{postType:"movie",selectedPostIds:d?d.split(",").map(Number):[],updateSelectedPostIds:function(e){n({ids:e.join(",")})}}),wp.element.createElement(u,{label:"Featured",help:"Check to select featured movies.",checked:m,onChange:function(e){n({featured:e})}}),wp.element.createElement(u,{label:"Top Rated",help:"Check to select top rated movies.",checked:h,onChange:function(e){n({top_rated:e})}})),wp.element.createElement(l,{block:"masvideos/movies",attributes:t})]},save:function(){return null}})},{"../components/PostSelector":4}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Post=void 0;n.Post=function(e){var t=e.title,n=(t=void 0===t?{}:t).rendered,o=e.clickHandler,r=e.id,i=e.icon;return wp.element.createElement("article",{className:"post"},wp.element.createElement("div",{className:"post-body"},wp.element.createElement("h3",{className:"post-title"},n)),wp.element.createElement("button",{onClick:function(){return o(r)}},i))}},{}],3:[function(e,t,n){"use strict";function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}Object.defineProperty(n,"__esModule",{value:!0}),n.PostList=void 0;var r=e("./Post");n.PostList=function(e){var t=e.filtered,n=void 0!==t&&t,i=e.loading,s=void 0!==i&&i,l=e.posts,a=void 0===l?[]:l,c=e.action,u=void 0===c?function(){}:c,p=e.icon,f=void 0===p?null:p;return s?wp.element.createElement("p",{className:"loading-posts"},"Loading posts..."):n&&a.length<1?wp.element.createElement("div",{className:"post-list"},wp.element.createElement("p",null,"Your query yielded no results, please try again.")):!a||a.length<1?wp.element.createElement("p",{className:"no-posts"},"No posts."):wp.element.createElement("div",{"class":"post-list"},a.map(function(e){return wp.element.createElement(r.Post,o({key:e.id},e,{clickHandler:u,icon:f}))}))}},{"./Post":2}],4:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return l(e)||s(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function l(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){c(e,t,n[t])})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?y(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Object.defineProperty(n,"__esModule",{value:!0}),n.PostSelector=void 0;var b=e("./PostList"),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t["default"]=e,t}(e("../utils/api")),g=e("../utils/useful-funcs"),w=wp.components.Icon,O=wp.element.Component,S=function(e){function t(e){var n;return u(this,t),n=d(this,m(t).apply(this,arguments)),n.props=e,n.state={posts:[],loading:!1,type:e.postType||"post",types:[],filter:"",filterLoading:!1,filterPosts:[],initialLoading:!1},n.addPost=n.addPost.bind(y(y(n))),n.removePost=n.removePost.bind(y(y(n))),n.handleInputFilterChange=n.handleInputFilterChange.bind(y(y(n))),n.doPostFilter=(0,g.debounce)(n.doPostFilter.bind(y(y(n))),300),n}return h(t,O),f(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({initialLoading:!0}),P.getPostTypes().then(function(t){e.setState({types:t},function(){e.retrieveSelectedPosts().then(function(){e.setState({initialLoading:!1})})})})}},{key:"getPosts",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=this.props.selectedPostIds,o=a({},{per_page:10,type:this.state.type,search:this.state.filter},t);return o.restBase=this.state.types[this.state.type].rest_base,P.getPosts(o).then(function(t){return o.search?(e.setState({filterPosts:t.filter(function(e){var t=e.id;return-1===n.indexOf(t)})}),t):(e.setState({posts:(0,g.uniqueById)([].concat(r(e.state.posts),r(t)))}),t)})}},{key:"getSelectedPosts",value:function(){var e=this,t=this.props.selectedPostIds;return this.state.posts.filter(function(e){var n=e.id;return-1!==t.indexOf(n)}).sort(function(t,n){var o=e.props.selectedPostIds.indexOf(t.id),r=e.props.selectedPostIds.indexOf(n.id);return o>r?1:o<r?-1:0})}},{key:"retrieveSelectedPosts",value:function(){var e=this.props,t=e.postType,n=e.selectedPostIds;this.state.types;return n&&!n.length>0?new Promise(function(e){return e()}):this.getPosts({include:this.props.selectedPostIds.join(","),per_page:100,postType:t})}},{key:"addPost",value:function(e){if(this.state.filter){var t=this.state.filterPosts.filter(function(t){return t.id===e}),n=(0,g.uniqueById)([].concat(r(this.state.posts),r(t)));this.setState({posts:n})}this.props.updateSelectedPostIds([].concat(r(this.props.selectedPostIds),[e]))}},{key:"removePost",value:function(e){this.props.updateSelectedPostIds(r(this.props.selectedPostIds).filter(function(t){return t!==e}))}},{key:"handleInputFilterChange",value:function(){var e=this,t=(arguments.length>0&&arguments[0]!==undefined?arguments[0]:{}).target,n=(t=void 0===t?{}:t).value,o=void 0===n?"":n;this.setState({filter:o},function(){if(!o)return e.setState({filteredPosts:[],filtering:!1});e.doPostFilter()})}},{key:"doPostFilter",value:function(){var e=this,t=this.state.filter;(void 0===t?"":t)&&(this.setState({filtering:!0,filterLoading:!0}),this.getPosts().then(function(){e.setState({filterLoading:!1})}))}},{key:"render",value:function(){var e=this.state.filtering,t=e&&!this.state.filterLoading?this.state.filterPosts:[],n=this.getSelectedPosts(),o=wp.element.createElement(w,{icon:"plus"}),r=wp.element.createElement(w,{icon:"minus"});return wp.element.createElement("div",{className:"components-base-control components-post-selector"},wp.element.createElement("div",{className:"components-base-control__field"},wp.element.createElement("label",{htmlFor:"searchinput",className:"components-base-control__label"},wp.element.createElement(w,{icon:"search"})),wp.element.createElement("input",{className:"components-text-control__input",id:"searchinput",type:"search",placeholder:"Please enter your search query...",value:this.state.filter,onChange:this.handleInputFilterChange}),wp.element.createElement(b.PostList,{posts:t,loading:this.state.initialLoading||this.state.loading||this.state.filterLoading,filtered:e,action:this.addPost,icon:o})),wp.element.createElement("div",{className:"components-base-control__field--selected"},wp.element.createElement("h2",null,"Selected"),wp.element.createElement(b.PostList,{posts:n,loading:this.state.initialLoading,action:this.removePost,icon:r})))}}]),t}();n.PostSelector=S},{"../utils/api":5,"../utils/useful-funcs":6,"./PostList":3}],5:[function(e,t,n){"use strict";function o(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function r(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}Object.defineProperty(n,"__esModule",{value:!0}),n.getPosts=n.getPostTypes=void 0;var i=wp.apiFetch;n.getPostTypes=function(){return i({path:"/wp/v2/types"})};n.getPosts=function(e){var t=e.restBase,n=void 0!==t&&t,r=o(e,["restBase"]),s=Object.keys(r).map(function(e){return"".concat(e,"=").concat(r[e])}).join("&"),l="/wp/v2/".concat(n,"?").concat(s,"&_embed");return i({path:l})}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.debounce=n.uniqueById=n.uniqueBy=void 0;var o=function(e,t){var n=[];return e.filter(function(e){return-1===n.indexOf(e[t])&&n.push(e[t])})};n.uniqueBy=o;n.uniqueById=function(e){return o(e,"id")};n.debounce=function(e,t){var n=null;return function(){var o=this,r=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(o,r)},t)}}},{}]},{},[1]);